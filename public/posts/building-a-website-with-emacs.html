<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2022-08-02 Tue 10:32 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Building a website with Emacs</title>
<meta name="author" content="Aziz Ben Ali" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" href="/stylesheets/main.css">
<link rel="icon" type="image/x-icon" href="/images/favicon.ico">
</head>
<body>
<div id="preamble" class="status">
<ul class="navigation">
  <li><a href="/index.html">Home</a></li>
  <li><a href="/contact.html">Contact</a></li>
  <li><a href="/data/resume.pdf">Résumé</a></li>
</ul>
</div>
<div id="content" class="content">
<header>
<h1 class="title">Building a website with Emacs</h1>
</header><nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#getting-started"><a href="#getting-started">An example to get you started</a></a></li>
<li><a href="#initialization"><a href="#initialization">Initialization</a></a></li>
<li><a href="#setup"><a href="#setup">Setup</a></a></li>
</ul>
</div>
</nav>
<p>
I would like to make a confession&#x2026; I detest most websites I visit on
a daily basis. I wanted to make a difference with my little personal
corner of the internet. What do you know? <i>Emacs can totally do that</i>.
</p>

<p>
You see, Emacs packs an exceptional mode, called Org Mode, that comes
with many wonderful functionalities. That which powers this website
goes by <code>org-publish-project-alist</code>.
</p>

<p>
In short, you specify where a particular <code>$thing</code> is, and where it
should go upon export. The <i>really fun</i> part is, we have the utmost
freedom to design our own file hierarchy - here's what
I've come up with:
</p>

<pre class="example" id="orgea4f66d">
~/projects/grtcdr.github.io
├── org/
│   ├── blog/
│   ├── css/
│   ├── data/
│   ├── img/
│   ├── index.org
│   └── contact.org
│
└── html/      ------  This directory is generated by org-publish
    ├── blog/
    ├── css/
    ├── data/
    ├── img/
    ├── index.html
    └── contact.html
</pre>

<div id="outline-container-getting-started" class="outline-2">
<h2 id="getting-started"><a href="#getting-started">An example to get you started</a></h2>
<div class="outline-text-2" id="text-getting-started">
<p>
I'd like to introduce you to the most basic form of a working <code>org-publish-project-alist</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(require 'ox-html)

(setq org-publish-project-alist
      '(("example.com/org"
	 :base-directory "~/website/org/"
	 :base-extension "org"
	 :publishing-directory "~/website/html/"
	 :publishing-function org-html-publish-to-html)))
</pre>
</div>

<p>
What happens when you create a <code>.org</code> document within your
<code>:base-directory</code> &#x2013; save it &#x2013; hit <code>M-x org-publish RET</code>, is nothing
short of magic!
</p>

<p>
Org, being the smarty-pants tool it is, takes the original file and
publishes it to <code>:publishing-directory</code> in <code>HTML</code> format.
</p>

<p>
That's exactly what we would need if we had tens or hundreds of <code>.org</code>
documents and wanted to automate the export process.
</p>

<p>
Things to keep in mind:
</p>
<ul class="org-ul">
<li><code>:base-extension</code> expects an extension, without a <code>.</code> prefix.</li>
<li><code>:publishing-function</code> depends on the type of content you intend to export.</li>
</ul>

<p>
Let's have a look at another example, though this time, we'll
export some stylesheets, too.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(setq org-publish-project-alist
     '(("example.com/org"
	 :base-directory "~/website/org/"
	 :base-extension "org"
	 :publishing-directory "~/website/html/"
	 :publishing-function org-html-publish-to-html)
       ("example.com/css"
	 :base-directory "~/website/css/"
	 :base-extension "css"
	 :publishing-directory "~/website/css/"
	 :publishing-function org-publish-attachment)))
</pre>
</div>

<p>
Now we have two different publishing projects, one for <code>org</code> documents
and another for <code>css</code>.
</p>

<p>
The main differences being, the <code>:publishing-function</code> and the project
identifier, i.e. the <code>CAR</code> of the association list. My advice, pick
meaningful names for your project identifiers. It doesn't necessarily
have to start with a URL, that's just my preference.
</p>

<p>
Okay! This is enough to get your website rolling, although you might want to
see the next section for a more complicated setup.
</p>
</div>
</div>

<div id="outline-container-initialization" class="outline-2">
<h2 id="initialization"><a href="#initialization">Initialization</a></h2>
<div class="outline-text-2" id="text-initialization">
<p>
I always like to experiment with the structure of my <code>$HOME</code>, which
leaves me with a temporarily broken setup sometimes.
</p>

<p>
I took the steps to remedy this with a few functions, which I'll use
with the <code>:base-directory</code> and <code>:publishing-directory</code> properties, the
more sensitive area of this setup.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(defvar site-base-directory
  "~/projects/grtcdr.github.io/"
  "The base of the site where files will are to be processed and exported.")

(defun site-content-directory (context &amp;optional directory)
  "Prefixes the provided DIRECTORY with the ’site-base-directory’ given the CONTEXT."
  (cond ((equal context 'publish) (concat site-base-directory "html/" directory))
	((equal context 'base) (concat site-base-directory "org/" directory))))
</pre>
</div>

<p>
<code>site-base-directory</code> is the base location of my site, and
<code>site-content-directory</code> will build a path depending on the parameters
I pass. This makes it a lot safer if I ever decide to move things
around.
</p>
</div>
</div>

<div id="outline-container-setup" class="outline-2">
<h2 id="setup"><a href="#setup">Setup</a></h2>
<div class="outline-text-2" id="text-setup">
<p>
Now I'd like to present my setup. It does all of the heavy lifting for
me, and allows me to focus on more important things - like chatting
with strangers on IRC :^)
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package ox-publish
  :custom
  (org-publish-project-alist
   `(("grtcdr.github.io/content"
      :base-directory ,(site-content-directory 'base)
      :base-extension "org"
      :publishing-directory ,(site-content-directory 'publish)
      :publishing-function org-html-publish-to-html
      :exclude "\\(README\\|setup\\).org"
      :recursive t
      :sitemap-filename "index.org"
      :sitemap-title "grtcdr's website"
      :with-author nil
      :with-creator nil
      :with-date nil
      :with-email nil
      :with-title nil
      :with-toc nil
      :section-numbers nil)

     ("grtcdr.github.io/img"
      :base-directory ,(site-content-directory 'base "img/")
      :base-extension "png\\|jpe?g"
      :publishing-directory ,(site-content-directory 'publish "img/")
      :publishing-function org-publish-attachment)

     ("grtcdr.github.io/blog"
      :base-directory ,(site-content-directory 'base "blog/")
      :base-extension "org"
      :publishing-directory ,(site-content-directory 'publish "blog/")
      :publishing-function org-html-publish-to-html
      :exclude ".\\(setup\\|navigation\\).org"
      :with-date t
      :with-title nil
      :with-toc nil
      :section-numbers nil)

     ("grtcdr.github.io/css"
      :base-directory ,(site-content-directory 'base "css/")
      :base-extension "css"
      :publishing-directory ,(site-content-directory 'publish "css/")
      :publishing-function org-publish-attachment)

     ("grtcdr.github.io/data"
      :base-directory ,(site-content-directory 'base "data/")
      :base-extension "txt\\|pdf"
      :publishing-directory ,(site-content-directory 'publish "data/")
      :publishing-function org-publish-attachment)

     ("grtcdr.github.io"
      :components ("grtcdr.github.io/img" "grtcdr.github.io/data" "grtcdr.github.io/css" "grtcdr.github.io/content" "grtcdr.github.io/blog")))))
</pre>
</div>

<p>
There's a project identifier for every <b>component</b> of the website, and
the last one groups them all together, so that I don't have to
selectively export every single one.
</p>

<p>
If you'd like to explore this topic in greater detail,
please read <a href="https://orgmode.org/worg/org-tutorials/org-publish-html-tutorial.html">the wonderful documentation</a> provided by the Org project.
</p>

<p>
<i>Farewell!</i>
</p>
</div>
</div>
</div>
</body>
</html>
